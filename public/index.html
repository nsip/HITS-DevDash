<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">

    <title>NSIP: Developer Dashboard</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <link href="css/alertify.core.css" rel="stylesheet">
    <link href="css/alertify.default.css" rel="stylesheet">
    <link href="lib/jquery.loadmask.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/dashboard.css" rel="stylesheet">

	<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.1/styles/default.min.css">

<style>
	.create_title {
		text-align: right;
		display: inline-block;
		width: 275px;
	}
	.create_element {
		display: inline-block;
		width: 150px;
	}
	.create_info {
		color: red;
	}
	#create_results {
		border: 1px solid black;
	}
</style>
  </head>

<!--

Design changes:

	* Entry View
		- Jump buttons at the top to Detail, Request, Response
		- Details across the top should be neat, not list items !
		- Headers and XML sections should be max size and scrollable
		- Expansion button on errors for XML (TBC)
		- EXPAND the XML Views - button that makes them big.
	* Client
		- Fix height. Added lots of height:100% still not working !
		- Pretty boarder on iframe
	* Header
		http://www.nsip.edu.au/ - logo?
	* Information
		- Pretty

-->

<body style="height: 100%;">

<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container-fluid">
	<div class="navbar-header">
	  <div class="logo"><a href="http://www.nsip.edu.au/"><img src="images/logo-small.png"></a></div>
	  	  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	    <span class="sr-only">Toggle navigation</span>
	    <span class="icon-bar"></span>
	    <span class="icon-bar"></span>
	    <span class="icon-bar"></span>
	  </button>
	  <a class="navbar-brand" href="#">NSIP: Developer Dashboard</a>
	</div>
	<div class="navbar-collapse collapse">
	  <ul class="nav navbar-nav navbar-right">
	    <li><a href="#">Dashboard</a></li>
	    <li><a href="http://hits.dev.nsip.edu.au/site/user">Settings</a></li>
	    <li><a href="http://hits.dev.nsip.edu.au/site/">HITS</a></li>
	    <li><a href="http://hits.dev.nsip.edu.au/site/help-developer-dashboard">Help</a></li>
	  </ul>
<!--
	  <form class="navbar-form navbar-right">
	    <input type="text" class="form-control" placeholder="Search...">
	  </form>
-->
	</div>
  </div>
</div>


<div class="container-fluid" style="height: 100%;">
  <div class="row" style="height: 100%;">

	<div class="col-sm-3 col-md-2 sidebar">
	  <ul class="nav nav-sidebar">
	    <li class="hdd-nav active"><a id="hdd-nav-info" href="#hdd-body-info">Information</a></li>
	    <li class="hdd-nav"><a id="hdd-nav-create" href="#hdd-body-create">Create</a></li>
	    <li class="hdd-nav"><a id="hdd-nav-dashboard" href="#hdd-body-dashboard">Dashboard</a></li>
	    <li class="hdd-nav"><a id="hdd-nav-client" href="#hdd-body-client">Client</a></li>
	    <li class="hdd-nav"><a id="hdd-nav-view" href="#hdd-body-view">View</a></li>
	    <li class="hdd-nav"><a id="hdd-nav-report" href="#hdd-body-report">Report</a></li>
	  </ul>
	</div>



	
	<!-- ====================================================================== 
			INFORMATION
	-->
	<div style="display:none" class="hdd-body col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main" id="hdd-body-create">
	  <h1 class="page-header">Create</h1>

	  <form id="create_form">
		<div class="create_field">
			<span class="create_title" id="create_dbname_title">Database name:</span>
			<span class="create_element">
				<input class="create_control" name="dbname" id="create_dbname" />
			</span>
			<span class="create_info" id="create_dbname_info"> </span>
		</div>

		<div class="create_field">
			<span class="create_title" id="create_schools_title">Number of schools:</span>
			<span class="create_element">
				<select class="create_control" name="schools" id="create_schools">
					<option value="0">None</option>
					<option value="1">1</option>
					<option value="5">5</option>
					<option value="10">10</option>
					<option value="50">50</option>
					<option value="100">100</option>
					<option value="200">200</option>
					<option value="500">500</option>
				</select>
			</span>
			<span class="create_info" id="create_schools_info"> </span>
		</div>
		
		<div class="create_field">
			<span class="create_title" id="create_staff_title">Number of staff: (per school, random)</span>
			<span class="create_element">
				<select class="create_control" name="staff" id="create_staff">
					<option value="0">None</option>
					<option value="1">1</option>
					<option value="2-5">2-5</option>
					<option value="5-20">5-20</option>
					<option value="10-30">10-30</option>
				</select>
			</span>
			<span class="create_info" id="create_staff_info"> </span>
		</div>

		<div class="create_field">
			<span class="create_title" id="create_students_title">Number of students: (per school, random)</span>
			<span class="create_element">
				<select class="create_control" name="students" id="create_students">
					<option value="0">None</option>
					<option value="1">1</option>
					<option value="10-50">10-50</option>
					<option value="50-100">50-100</option>
					<option value="50-200">50-200</option>
					<option value="100-200">100-200</option>
					<option value="150-300">150-300</option>
					<option value="300-500">300-500</option>
					<option value="400-1000">400-1000</option>
				</select>
			</span>
			<span class="create_info" id="create_students_info"> </span>
		</div>
		  
		<div class="create_field">
			<span class="create_title" id="create_rooms_title">Number of rooms: (per school, random)</span>
			<span class="create_element">
				<select class="create_control" name="rooms" id="create_rooms">
					<option value="0">None</option>
					<option value="1">1</option>
					<option value="3-5">3-5</option>
					<option value="3-20">3-20</option>
					<option value="10-25">10-25</option>
					<option value="15-35">15-35</option>
				</select>
			</span>
			<span class="create_info" id="create_rooms_info"> </span>
		</div>

		<div class="create_field">
			<span class="create_title" id="create_teachinggroups_title">Teaching groups: </span>
			<span class="create_element">
				<input class="create_control" type="checkbox" value="yes" id="create_teachinggroups" />
			</span>
			<span class="create_info" id="create_teachinggroups_info"> </span>
		</div>

		<div class="create_field">
			<span class="create_title" id="create_timetable_title">Timetable: </span>
			<span class="create_element">
				<input class="create_control" type="checkbox" value="yes" id="create_timetable" />
			</span>
			<span class="create_info" id="create_timetable_info"> </span>
		</div>

		<div class="create_field">
			<span class="create_title" id="create_grading_title">Grading: </span>
			<span class="create_element">
				<input class="create_control" type="checkbox" value="yes" id="create_grading" />
			</span>
			<span class="create_info" id="create_grading_info"> </span>
		</div>

		<div class="create_field">
			<span class="create_title" id="create_contact_information_title">Contact information: </span>
			<span class="create_element">
				<input class="create_control" type="checkbox" value="yes" id="create_contact_information" />
			</span>
			<span class="create_info" id="create_contact_information_info"> </span>
		</div>

		<div class="create_field">
			<span class="create_title" id="create_accoutns_title">Accounts: </span>
			<span class="create_element">
				<input class="create_control" type="checkbox" value="yes" id="create_accounts" />
			</span>
			<span class="create_info" id="create_accounts_info"> </span>
		</div>

		<div class="create_field">
			<span class="create_title" id="create_vendors_title">Vendors: </span>
			<span class="create_element">
				<input class="create_control" type="checkbox" value="yes" id="create_vendors" />
			</span>
			<span class="create_info" id="create_vendors_info"> </span>
		</div>

		<div class="create_field">
			<span class="create_title" id="create_debtors_title">Debtors: </span>
			<span class="create_element">
				<input class="create_control" type="checkbox" value="yes" id="create_debtors" />
			</span>
			<span class="create_info" id="create_debtors_info"> </span>
		</div>

		<div class="create_field">
			<span class="create_title" id="create_submit_title"></span>
			<span class="create_element">
				<input class="create_submit" type="submit" value="submit" id="create_submit" />
			</span>
			<span class="create_info" id="create_submit_info"> </span>
		</div>



	  </form>

	  <div id="create_results">

<!--
      Options
        - Number of schools - always on
        - Number of Students - must have 1+ schools
        - Number of Staff - must have 1+ schools
        - Rooms - must have 1+ schools
        - Teaching groups
        - Time Table
        - Grading
        - Student Contacts - must have 1+ students/staff
        - Accounts
        - Vendors
        - Debtors
		- Apply button


      Use Cases:
        - Drop down list of use cases
			On click - select new Description below
        - Shows a text description of each
        - Apply button
			On click - Overwrite options to the left
        
-->
	  </div>


	<div>
		<a href="#" id="create_reset">Reset Form</a>
	</div>

	</div>


	<!-- ====================================================================== 
			INFORMATION
	-->
	<div class="hdd-body col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main" id="hdd-body-info">
	  <h1 class="page-header">Information</h1>

			<div class="alert alert-danger" id="hdd-info-error">
				Error - unable to access developer details.
				<a href="http://hits.dev.nsip.edu.au/site/help-developer-dashboard">Help...</a>
				<div id="hdd-info-error-details">...</div>
			</div>

		  <div class="table-responsive">
			<table class="table table-striped">
			  <thead>
			<tr>
			  <th>Info</th>
			  <th>Data</th>
			</tr>
			  </thead>
			  <tbody>
			<tr>
			  <td>Environment Base URL</td>
			  <td><span class="info_field" dataid="info.href">...</span></td>
			</tr>

			<tr>
			  <td>Vendor Name</td>
			  <td><span class="info_field" dataid="vendor.name">...</span></td>
			</tr>
			<tr>
			  <td>App Name / Title</td>
			  <td><span class="info_field" dataid="app.name">...</span>
			  	/
				<span class="info_field" dataid="app.title">...</span>
			  </td>
			</tr>

			<tr>
			  <td>SIF applicationKey</td>
			  <td><span class="info_field" dataid="info.applicationKey">...</span></td>
			</tr>
			<tr>
			  <td>SIF userToken</td>
			  <td><span class="info_field" dataid="info.userToken">...</span></td>
			</tr>
			<tr>
			  <td>SIF solutionId</td>
			  <td><span class="info_field" dataid="info.solutionId">...</span></td>
			</tr>
			<tr>
			  <td>SIF password</td>
			  <td><span class="info_field" dataid="info.password">...</span></td>
			</tr>

			<tr>
			  <td>sessionToken</td>
			  <td><span class="info_field" dataid="info.sessionToken">...</span></td>
			</tr>
			<tr>
			  <td>Environment URL</td>
			  <td><span class="info_field" dataid="info.environmentURL">...</span></td>
			</tr>
			<tr>
			  <td>Request Base URL</td>
			  <td><span class="info_field" dataid="info.requestHREF">...</span></td>
			</tr>

			<tr>
			  <td>SIF Javascript Client</td>
<!-- XXX Wrong calling parameters now !!! -->
			  <td><a class="hdd-clienturl" href="http://hits.dev.nsip.edu.au/client/Simple/?">HITS SIF Simple Client</a></td>
			</tr>


			  </tbody>
			</table>
		  </div>


			<h2 class="subsequent">Brief instructions</h2>
			<p>Using the navigation on the left, select the following options:
			<ul>
				<li>Information - Tokens, IDs and other getting started information</li>
				<li>Dashboard - View XML requests to the SIF Server</li>
				<li>Client - An embedded SIF 3 Client allowing GET and POST requests</li>
				<li>View - Direct database view - all tables, all rows, useful for debugging</li>
				<li>Report - View preliminary report matching this Use Case</li>
			</p>

		</div>

	<!-- ====================================================================== 
			DASHBOARD
	-->
	<div style="display:none" class="hdd-body col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main" id="hdd-body-dashboard">
	  <h1 class="page-header">Dashboard</h1>

		<button id="hdd-dashboard-refresh" type="button" class="btn btn-default btn-lg btn-right">
		  <span class="glyphicon glyphicon-refresh"></span> Refresh
		</button>


	  <div class="table-responsive">
	    <table id="hdd-dashboard-data" class="table table-striped">
	      <thead>
		<tr>
		  <th>#</th>
		  <th>Method</th>
		  <th>Status</th>
		  <th>Time</th>
		  <th>URL</th>
		</tr>
	      </thead>
	      <tbody>
		<tr>
		  <td>Click refresh / Loading...</td>
		</tr>
	      </tbody>
	    </table>
	  </div>
	</div>


	<!-- ====================================================================== 
			DASHBOARD - View
	-->
	<div style="display:none" class="hdd-body col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main" id="hdd-body-dashboard-view">
	  <h1 class="page-header">Entry view</h1>

		<button id="hdd-dashboard-back" type="button" class="btn btn-default btn-lg btn-right">
		  <span class="glyphicon glyphicon-arrow-left"></span> Back
		</button>

		<h2>Details</h2>
		<ul class="details half">
			<li>ID: <span class="field" dataid="id">...</span>
			<li>instance ID: <span class="field" dataid="instanceId">...</span>
			<li>Zone: <span class="field" dataid="zone">...</span>
			<li>Enviornment Token: <span class="field" dataid="enviornmentToken">...</span>
			<li>Session Token: <span class="field" dataid="sessionToken">...</span>
		</ul>
		<ul class="details half">
			<li>App Key: <span class="field" dataid="appKey">...</span>
			<li>Context: <span class="field" dataid="context">...</span>
			<li>User Token: <span class="field" dataid="userToken">...</span>
			<li>Zone: <span class="field" dataid="zone">...</span>
			<li>Solution ID: <span class="field" dataid="solutionId">...</span>
			<li>Client IP: <span class="field" dataid="clientIp">...</span>
		</ul>
		
		<div class="clear"></div>

		<h2 class="subsequent">Request</h2>
		<ul class="details">
			<li>URL: <span class="field" dataid="url">...</span>
			<li>Method: <span class="field" dataid="method">...</span>
			<li>Query Parameters: <span class="field" dataid="queryParameters">...</span>
			<li>Request Time: <span class="field" dataid="requestTime">...</span>
		</ul>
		
		<div class="clear"></div>
		
		<h3>Request headers</h3>
		<pre><code class="field" dataid="requestHeaders"></code></pre>
		<h3>Request body</h3>
		<pre><code class="field xml" dataid="request"></code></pre>

		<h2 class="subsequent">Response</h2>
		
		<ul class="details half">
			<li>Response Time: <span class="field" dataid="responseTime">...</span>
		</ul>
		<ul class="details half">
			<li>HTTP Status: <span class="field" dataid="httpStatus">...</span>
		</ul>
		
		<div class="clear"></div>
		
		<h3>Response headers</h3>
		<pre><code class="field" dataid="responseHeaders"></code></pre>
		<h3>Response body</h3>
		<pre><code class="field xml" dataid="response"></code></pre>

	</div>


	<!-- ====================================================================== 
			CLIENT
	-->
	<div style="display:none" class="hdd-body col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main" id="hdd-body-client">
	  <h1 class="page-header">Client access</h1>

	  	<!-- TODO Better presentation of this list/menu -->

		<a href="http://hits.dev.nsip.edu.au/sifdoc/SIFSimple/">View Swagger documentation</a>
		|

		<!-- TODO Links to auto generated examples -->
		<a href="#">Display CURL example</a>
		|

		<a href="#">Display Perl example</a>
		|

		<a href="#">Display JAVA example</a>
		|

		<a href="#">Display C# example</a>
		|

		<a href="#">Other examples</a>

		
<!-- XXX Wrong calling parameters now !!! -->
		<iframe style="height: 640px; width: 100%;" class="hdd-clienturl" src="http://hits.dev.nsip.edu.au/client/Simple/?">
		</iframe>
	</div>

	<!-- ====================================================================== 
			VIEW
	-->
	<div style="display:none" class="hdd-body col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main" id="hdd-body-view">
	  <h1 class="page-header">View database</h1>
		<ul id="hdd-body-view-list">
		</ul>
	</div>

	<!-- ====================================================================== 
			VIEW - Table
	-->
	<div style="display:none" class="hdd-body col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main" id="hdd-body-view-table">
	  <h1 class="page-header">View database</h1>
		<button id="hdd-view-back" type="button" class="btn btn-default btn-lg btn-right">
		  <span class="glyphicon glyphicon-arrow-left"></span> Back
		</button>
		<h2 id="hbv-tablename">...</h2>

			<div class="table-responsive">
				<table id="hbv-data" class="table table-striped">
				<thead>
					<tr>
						<th>Loading...</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>Loading...</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>

	<!-- ====================================================================== 
			REPORT
	-->
	<div style="display:none" class="hdd-body col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main" id="hdd-body-report">
	  <h1 class="page-header">Report</h1>
		<select id="select-report">
			<option>TimeTable</option>
			<option>Attendance</option>
			<option>NAP_Registration</option>
			<option>ClassroomAssessment</option>
			<option>Enrollment</option>
			<option>Financial</option>
			<option>NAP_Registration_Aggregated</option>
		</select>
		<button id="hdd-report" type="button" class="btn btn-default btn-lg btn-right">
		  <span class="glyphicon glyphicon-refresh"></span> Report
		</button>

		<div id="hbr-data" style="min-height: 150px;">
			<p>Click report above to laod report - be patient, can take some time...</p>
		</div>

	</div>


  </div>
</div>

<script src="lib/jquery.js"></script>
<script src="lib/jquery.rest.js"></script>
<script src="lib/jquery.loadmask.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="lib/purl.js"></script>
<script src="lib/alertify.js"></script>
<script src="lib/jquery.tablesorter.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.1/highlight.min.js"></script>
<script src="hits.devdash.js"></script>

		<script>

			var updateCreate = function() {
				var schools = ($('#create_schools').val() != '0');
				var staff = schools && ($('#create_staff').val() != '0');
				var students = schools && ($('#create_students').val() != '0');
				var rooms = schools && ($('#create_rooms').val() != '0');

				// ACCOUNTS
				if (schools && $('#create_accounts').is(':checked')) {
					$( "#create_vendors" ).prop( "disabled", false );
					$( "#create_vendors_info" ).html("");
					$( "#create_debtors" ).prop( "disabled", false );
					$( "#create_debtors_info" ).html("");
				}
				else {
					$( "#create_vendors" ).prop( "disabled", true );
					$( "#create_vendors_info" ).html("Need to enable accounts with 1 or more schools");
					$( "#create_debtors" ).prop( "disabled", true );
					$( "#create_debtors_info" ).html("Need to enable accounts with 1 or more schools");
				}

				// STAFF/STUDENTS/TEACHINGGROUPS
				if (schools) {
					$( "#create_staff" ).prop( "disabled", false );
					$( "#create_staff_info" ).html("");
					$( "#create_students" ).prop( "disabled", false );
					$( "#create_students_info" ).html("");
					$( "#create_teachinggroups" ).prop( "disabled", false );
					$( "#create_teachinggroups_info" ).html("");
					$( "#create_rooms" ).prop( "disabled", false );
					$( "#create_rooms_info" ).html("");
					$( "#create_accounts" ).prop( "disabled", false );
					$( "#create_accounts_info" ).html("");
				}
				else {
					$( "#create_staff" ).prop( "disabled", true );
					$( "#create_staff_info" ).html("Need 1 or more schools");
					$( "#create_students" ).prop( "disabled", true );
					$( "#create_students_info" ).html("Need 1 or more schools");
					$( "#create_teachinggroups" ).prop( "disabled", true );
					$( "#create_teachinggroups_info" ).html("Need 1 or more schools");
					$( "#create_rooms" ).prop( "disabled", true );
					$( "#create_rooms_info" ).html("Need 1 or more schools");
					$( "#create_accounts" ).prop( "disabled", true );
					$( "#create_accounts_info" ).html("Need 1 or more schools");
				}

				// TIMETABLE / GRADING
				if ( (staff || students) && rooms && $('#create_teachinggroups').is(':checked')) {
					$( "#create_grading" ).prop( "disabled", false );
					$( "#create_grading_info" ).html("");
					$( "#create_timetable" ).prop( "disabled", false );
					$( "#create_timetable_info" ).html("");
				}
				else {
					$( "#create_grading" ).prop( "disabled", true );
					$( "#create_grading_info" ).html("Need staff or students and teaching groups and rooms");
					$( "#create_timetable" ).prop( "disabled", true );
					$( "#create_timetable_info" ).html("Need staff or students and teaching groups and rooms");
				}

				// CONTACT INFORMATION
				if (staff || students) {
					$( "#create_contact_information" ).prop( "disabled", false );
					$( "#create_contact_information_info" ).html("");
				}
				else {
					$( "#create_contact_information" ).prop( "disabled", true );
					$( "#create_contact_information_info" ).html("Need staff or students");
				}
			};

			var htmlEntify = function(datain) {
				var ret = $('<div />').text(datain).html();
				return ret.replace(/\\n/, "\n");
			};

			$( document ).ready(function() {
				updateCreate();
				$('#create_submit').click(function() {
					$('#create_form').mask("Loading (this can take many minutes)...");

					$('#create_results').html("");
					//$("#create_form :input" ).prop( "disabled", true );
					//$("#create_form :select" ).prop( "disabled", true );
					$("#create_submit_info").html("Please wait... creating dataset");

					var url = "/dbapi/?encode=json";
					url += "&name=" + $('#create_dbname').val();
					url += "&schools=" + $('#create_schools').val();

					var jqxhr = $.ajax( url )
					.error(function(data) {
						$('#create_form').unmask();
						console.log("error", data);
						$('#create_results').html("<pre>ERRORS\n" + htmlEntify(data.responseText) + "</pre>");
					})
					.complete(function(data) {
						$('#create_form').unmask();
						console.log("complete", data);
						var results = $.parseJSON(data.responseText);
						if (results.success) {
							$('#create_results').html('<h1>Success</h1><a href="' + results.href + '">' + results.href + "</a><pre>Debugging\n\n" + htmlEntify(results.data) + '</pre>');
						}
						else {
							$('#create_results').html("<h1>Errors</h1><pre>" + htmlEntify(results.error) + "</pre>");
						}
						$('#create_form').hide();
					});

					return false;
				});
				$('.create_control').click(function() { 
					updateCreate();
				});
				$('#create_reset').click(function() {
					$('#create_results').html("");
					$('#create_submit_info').html("");
					$('#create_form').show();
					updateCreate();
				});
			});
		</script>

</body>
</html>
